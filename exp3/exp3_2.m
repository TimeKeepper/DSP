clc; % 清除命令窗口
clear; % 清除工作区变量

% 定义输入信号 x
x = [0, 1, 2, 3, 4, 5, 6, 7];
N = length(x); % 获取输入信号的长度

p = 0:N-1; % 定义时间索引，范围从 0 到 N-1
m = 0:4*N-1; % 定义扩展后的时间索引，范围从 0 到 4N-1

% 生成周期序列 x_p(n)
x_p = x(mod(m, N) + 1); % 通过取模操作生成周期序列，周期为 N

% 预分配频域信号 X_p 的大小
X_p = zeros(1, 4*N); % 初始化 X_p 为长度为 4N 的零向量

% 计算周期序列的离散傅里叶变换 (DFT)
for k = 1:4*N
    for n = 1:4*N
        % 计算 X_p(k) 的值，累加 x_p(n) 乘以复指数的结果
        X_p(k) = X_p(k) + x_p(n) * exp(-1i * 2 * pi / N) .^ ((n-1) * (k-1));
    end
end

% 绘制原始信号 x(n)
subplot(2,2,1); % 创建一个 2x2 的子图，并在第一个位置绘图
stem(p, x); % 绘制离散序列 x(n)
title('(a) 主值序列 x(n)'); % 设置图表标题

% 绘制周期序列信号 x_p(n)
subplot(2,2,2); % 在第二个位置绘图
stem(m, x_p); % 绘制离散序列 x_p(n)
title('(b) 周期序列信号 x_p(n)'); % 设置图表标题

% 绘制周期序列的幅度谱
subplot(2,2,3);
stem(m, abs(X_p));
title('(c) 周期序列的幅度谱');

% 绘制周期序列的相位谱
subplot(2,2,4);
stem(m, angle(X_p));
title('(d) 周期序列的相位谱');